-- KPIS:

-- Total Revenue :
select sum(total_price) As total_Revenue from pizza_db.pizza_sales;

-- Average order value :
select sum(total_price) / count( distinct order_id) As Average_Order_Value from pizza_db.pizza_sales;

-- Total Pizzas sold:
select sum(quantity) as Total_pizzas_sold from pizza_db.pizza_sales;

-- Total_orders:
select count( distinct order_id) as Total_orders from pizza_db.pizza_sales;
-- Average pizzas per order:
select Cast(sum(quantity) / count( distinct order_id) as decimal (10,2)) as Average_pizzas_per_order from pizza_db.pizza_sales;


-- Charts Requirement:

-- percentage of sales by pizza category:
select pizza_category,cast( sum(total_price)*100/(select sum(total_price) from pizza_db.pizza_sales)as decimal(10,2)) as percentage_of_sales
from pizza_db.pizza_sales
group by pizza_category;

-- percentage of sales by pizza size :
select pizza_size,cast( sum(total_price)*100/(select sum(total_price) from pizza_db.pizza_sales)as decimal(10,2)) as percentage_of_sales
from pizza_db.pizza_sales
group by pizza_size
order by percentage_of_sales desc;

-- Total pizzas sold by pizza category:
select pizza_category, sum(quantity) as total_pizzas_sold from pizza_db.pizza_sales;

-- Top 5 best sellers by total pizzas sold:
select pizza_name, sum(quantity) as total_pizzas_sold 
from pizza_db.pizza_sales
group by pizza_name
order by total_pizzas_sold desc
limit 5 ;

-- bottom 5 worst sellers by total pizzas sold:

select pizza_name, sum(quantity) as total_pizzas_sold 
from pizza_db.pizza_sales
group by pizza_name
order by total_pizzas_sold asc
limit 5 ;